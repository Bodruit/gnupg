--- gnupg-1.4.5/g10/openfile.c.orig	2006-07-31 16:00:19.000000000 +0200
+++ gnupg-1.4.5/g10/openfile.c	2006-12-01 10:59:02.049505000 +0100
@@ -144,8 +144,8 @@
 
     s = _("Enter new filename");
 
-    n = strlen(s) + namelen + 10;
     defname = name && namelen? make_printable_string( name, namelen, 0): NULL;
+    n = strlen(s) + (defname?strlen (defname):0) + 10;
     prompt = xmalloc(n);
     if( defname )
 	sprintf(prompt, "%s [%s]: ", s, defname );
